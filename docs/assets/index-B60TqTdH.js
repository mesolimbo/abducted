(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&e(h)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}})();const r={TITLE:"Abduction",SUBTITLE:"Chaos at The Farm",LOADING:"Loading...",LOADING_PROGRESS:d=>`Loading... ${d}%`,SCORE_PREFIX:"Score: ",HIGH_SCORE_PREFIX:"High Score: ",FUEL_LABEL:"GraviFuel",FUEL_WARNING:"Low Fuel! Drop to Recharge",FUEL_NORMAL:"Fly low to recharge",GAME_OVER_TITLE:"Game Over",REASON_UFO:"Crashed",REASON_COW:"Bovine Lost",NEW_HIGH_SCORE:"New High Score!",BTN_START:"Begin Abduction",BTN_RETRY:"Abduct Another",INSTRUCTIONS:{PILOT:"Pilot your vessel using",KEY_SPACE:"Spacebar",OR:"or",TOUCH:"Touch",CONTROLS:"Spacebar or Touch",GOAL:"Keep your bovine captive safe. Fly high to avoid buildings, but remember:",FUEL_RULE:"You must fly low to recharge your GravyFuel.",ALTITUDE_WARNING:"Flying higher is safer but drains fuel rapidly!",SURVIVAL_TIP:"Stay low to survive."}};class C extends Phaser.Scene{constructor(){super("BootScene")}preload(){const{width:t,height:i}=this.scale,e=this.add.text(t/2,i/2,r.LOADING,{fontFamily:"IM Fell English",fontSize:"32px",color:"#2c1c11"}).setOrigin(.5);this.load.image("ufo","assets/ufo.png"),this.load.image("ufo_thrust","assets/ufo_thrust.png"),this.load.aseprite("cow","assets/cow-sprite.png","assets/cow-sprite.json"),this.load.image("cow-static","assets/cow.png"),this.load.image("barn","assets/barn.png"),this.load.image("silo","assets/silo.png"),this.load.image("ground","assets/ground.png"),this.load.svg("beam","assets/beam.svg"),this.load.image("cloud","assets/cloud.png"),this.load.image("explosion","assets/explosion.png"),this.load.image("splat","assets/splat.png"),this.load.audio("gravidrive","assets/audio/gravidrive.mp3"),this.load.audio("crash","assets/audio/crash.mp3"),this.load.audio("splat","assets/audio/splat.mp3"),this.load.audio("moo","assets/audio/moo.mp3"),this.load.on("progress",s=>{e.setText(r.LOADING_PROGRESS(Math.round(s*100)))})}create(){this.scene.start("MenuScene")}}class D extends Phaser.Scene{constructor(){super("MenuScene")}create(){var T;const{width:t,height:i}=this.scale,e=t/2,s=i/2,o=i-80;for(let O=0;O<3;O++)this.add.image(Phaser.Math.Between(0,t),Phaser.Math.Between(50,200),"cloud").setAlpha(.3).setScale(Phaser.Math.FloatBetween(.5,1)).setDepth(0);this.add.tileSprite(t/2,i-40,t,80,"ground").setDepth(0),this.add.image(t*.6,o,"barn").setOrigin(.5,1).setDepth(0),this.add.image(t*.15,o-13,"cow-static").setScale(.6).setDepth(0),this.add.rectangle(e,s,t,i,15984336,.8).setDepth(1);const h=Math.min(480,t-40),n=Math.min(540,i-40),a=s-n/2;this.add.rectangle(e,s,h,n,15984336).setStrokeStyle(4,2890769).setDepth(2),this.add.rectangle(e,s,h-16,n-16).setStrokeStyle(1,2890769,.5).setDepth(2),this.add.text(e,a+50,r.TITLE,{fontFamily:"IM Fell English SC",fontSize:"52px",color:"#2c1c11"}).setOrigin(.5).setDepth(2),this.add.text(e,a+105,r.SUBTITLE,{fontFamily:"IM Fell English",fontSize:"22px",color:"#2c1c11",fontStyle:"italic"}).setOrigin(.5).setDepth(2);const l=a+135;this.add.rectangle(e,l,200,2,2890769).setDepth(2);const u=a+n-60,I=l+10,R=u-35,P=(I+R)/2,F={fontFamily:"IM Fell English",fontSize:"17px",color:"#2c1c11",align:"center",wordWrap:{width:h-60}},p=this.add.text(e,0,r.INSTRUCTIONS.PILOT,F).setOrigin(.5).setDepth(2),y=this.add.text(e,0,`${r.INSTRUCTIONS.KEY_SPACE} ${r.INSTRUCTIONS.OR} ${r.INSTRUCTIONS.TOUCH}`,{fontFamily:"IM Fell English",fontSize:"19px",color:"#991b1b",align:"center",fontStyle:"bold"}).setOrigin(.5).setDepth(2),S=this.add.text(e,0,r.INSTRUCTIONS.GOAL,F).setOrigin(.5).setDepth(2),f=this.add.text(e,0,r.INSTRUCTIONS.ALTITUDE_WARNING,F).setOrigin(.5).setDepth(2),b=this.add.text(e,0,r.INSTRUCTIONS.SURVIVAL_TIP,{fontFamily:"IM Fell English",fontSize:"19px",color:"#2c1c11",align:"center",fontStyle:"bold"}).setOrigin(.5).setDepth(2),w=8,E=16,v=p.height+y.height+S.height+f.height+b.height+w*2+E*2;let c=P-v/2;p.setY(c+p.height/2),c+=p.height+w,y.setY(c+y.height/2),c+=y.height+E,S.setY(c+S.height/2),c+=S.height+E,f.setY(c+f.height/2),c+=f.height+w,b.setY(c+b.height/2);const g=this.add.rectangle(e,u,220,50,2890769).setInteractive({useHandCursor:!0}).setDepth(2);this.add.text(e,u,r.BTN_START,{fontFamily:"IM Fell English",fontSize:"20px",color:"#f3e6d0"}).setOrigin(.5).setDepth(2),g.on("pointerover",()=>g.setFillStyle(4864810)),g.on("pointerout",()=>g.setFillStyle(2890769)),g.on("pointerdown",()=>this.startGame()),(T=this.input.keyboard)==null||T.on("keydown-SPACE",()=>this.startGame()),this.scale.on("resize",()=>this.scene.restart(),this)}startGame(){this.scene.start("GameScene")}}const m=4,A=.45,M=-.75,x=100,N=.4,_=.12,G=180;class L extends Phaser.Scene{constructor(){super("GameScene"),this.currentFuel=x,this.currentScore=0,this.highScore=0,this.spawnTimer=0,this.isDying=!1,this.introPhase=0,this.isPlaying=!1}init(){const t=localStorage.getItem("abduction-highscore");t&&(this.highScore=parseInt(t,10)),this.currentFuel=x,this.currentScore=0,this.spawnTimer=0,this.isDying=!1,this.introPhase=0,this.isPlaying=!1}create(){const{width:t,height:i}=this.scale;this.clouds=this.add.group();for(let o=0;o<3;o++){const h=Phaser.Math.FloatBetween(.4,1),n=50+(1-h)*200,a=this.clouds.create(t/3*o+Phaser.Math.Between(50,t/3-50),n,"cloud");a.setAlpha(.3),a.setScale(h),a.setDepth(6)}this.ground=this.add.tileSprite(t/2,i-40,t,80,"ground"),this.ground.setDepth(10),this.physics.add.existing(this.ground,!0),this.obstacles=this.physics.add.group();const e=i-80,s=this.obstacles.create(t*.6,e+10,"barn");s.setOrigin(.5,1),s.setDepth(5),s.body.setAllowGravity(!1),this.beam=this.add.image(0,0,"beam").setOrigin(.5,0).setVisible(!1),this.player=this.physics.add.sprite(-300,-300,"ufo"),this.player.setScale(1),this.player.setDepth(200),this.player.setCollideWorldBounds(!0),this.player.body.setAllowGravity(!1),this.player.body.setSize(this.player.width*.7,this.player.height*.4),this.anims.exists("dangling")||this.anims.create({key:"dangling",frames:this.anims.generateFrameNames("cow",{prefix:"cow ",suffix:".aseprite",start:0,end:8}),frameRate:12,repeat:-1}),this.cow=this.physics.add.sprite(t*.15,e-13,"cow"),this.cow.setScale(.6),this.cow.body.setAllowGravity(!1),this.cow.body.setSize(this.cow.width*.8,this.cow.height*.8),this.physics.add.overlap(this.cow,this.obstacles,()=>this.onFatalCollision("cow")),this.physics.add.overlap(this.player,this.obstacles,()=>this.onFatalCollision("ufo")),this.physics.add.collider(this.player,this.ground,()=>this.onFatalCollision("ufo")),this.physics.add.overlap(this.player,this.cow,()=>{Phaser.Math.Distance.Between(this.player.x,this.player.y,this.cow.x,this.cow.y)<40&&this.isPlaying&&!this.isDying&&this.onFatalCollision("both")}),this.spaceKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE),this.gravidriveSound=this.sound.add("gravidrive",{loop:!0}),this.crashSound=this.sound.add("crash"),this.splatSound=this.sound.add("splat"),this.mooSound=this.sound.add("moo"),this.createHUD(),this.scale.on("resize",this.onResize,this),this.introPhase=0}createHUD(){const{width:t}=this.scale;this.scoreText=this.add.text(24,24,r.SCORE_PREFIX+"0",{fontFamily:"IM Fell English SC",fontSize:"28px",color:"#2c1c11"}).setScrollFactor(0).setDepth(100),this.highScoreText=this.add.text(24,56,r.HIGH_SCORE_PREFIX+this.highScore,{fontFamily:"IM Fell English",fontSize:"14px",color:"#2c1c11",fontStyle:"italic"}).setScrollFactor(0).setDepth(100).setAlpha(.75);const i=180,e=t-i-24;this.fuelLabel=this.add.text(e+i/2,24,r.FUEL_LABEL,{fontFamily:"IM Fell English SC",fontSize:"14px",color:"#2c1c11"}).setOrigin(.5,0).setScrollFactor(0).setDepth(100),this.fuelBarBg=this.add.rectangle(e,44,i,16,16777215).setOrigin(0,0).setStrokeStyle(2,2890769).setScrollFactor(0).setDepth(100),this.fuelBarFill=this.add.rectangle(e+2,46,i-4,12,2890769).setOrigin(0,0).setScrollFactor(0).setDepth(100),this.fuelWarning=this.add.text(e+i/2,66,r.FUEL_WARNING,{fontFamily:"IM Fell English",fontSize:"12px",color:"#991b1b"}).setOrigin(.5,0).setScrollFactor(0).setDepth(100).setVisible(!1)}onFatalCollision(t){!this.isPlaying||this.isDying||(this.isDying=!0,this.beam.setVisible(!1),this.gravidriveSound.isPlaying&&this.gravidriveSound.stop(),this.mooTimer&&this.mooTimer.remove(),t==="ufo"?(this.add.image(this.player.x,this.player.y,"explosion").setScale(1.2),this.player.setVisible(!1),this.crashSound.play()):t==="cow"?(this.add.image(this.cow.x,this.cow.y,"splat").setScale(1),this.cow.setVisible(!1),this.mooSound.isPlaying&&this.mooSound.stop(),this.splatSound.play()):(this.add.image(this.cow.x,this.cow.y,"splat").setScale(1).setDepth(50),this.add.image(this.player.x,this.player.y,"explosion").setScale(1.2).setDepth(51),this.player.setVisible(!1),this.cow.setVisible(!1),this.mooSound.isPlaying&&this.mooSound.stop(),this.crashSound.play(),this.splatSound.play()),this.obstacles.getChildren().forEach(i=>{i.body&&(i.body.velocity.x=0)}),this.player.body.setGravityY(0),this.player.body.setVelocity(0,0),this.currentScore>this.highScore&&(this.highScore=this.currentScore,localStorage.setItem("abduction-highscore",this.highScore.toString())),this.time.delayedCall(700,()=>{this.scene.start("GameOverScene",{score:this.currentScore,highScore:this.highScore,deathReason:t})}))}onResize(t){const i=t.width,e=t.height;this.ground.width=i,this.ground.x=i/2,this.ground.y=e-40,this.ground.body&&this.ground.body.updateFromGameObject();const s=e-80;this.obstacles.children.iterate(n=>(n&&(n.y=s+10,n.body&&(n.body.y=s-n.displayHeight)),!0));const o=180,h=i-o-24;this.fuelLabel.setX(h+o/2),this.fuelBarBg.setX(h),this.fuelBarFill.setX(h+2),this.fuelWarning.setX(h+o/2)}update(t,i){const{height:e,width:s}=this.scale;if(!this.isPlaying&&!this.isDying){this.handleIntro(i,s,e);return}if(!this.isPlaying||this.isDying)return;const o=this.spaceKey.isDown||this.input.activePointer.isDown,h=e-80;if(o)if(this.currentFuel>0){this.player.body.velocity.y+=M*50;const l=1+Math.max(0,h-this.player.y)/e*2.8;this.currentFuel=Math.max(0,this.currentFuel-N*l),this.player.setTexture("ufo_thrust"),this.gravidriveSound.isPlaying||this.gravidriveSound.play()}else this.player.setTexture("ufo"),this.gravidriveSound.isPlaying&&this.gravidriveSound.stop();else this.player.setTexture("ufo"),this.currentFuel=Math.min(x,this.currentFuel+_),this.gravidriveSound.isPlaying&&this.gravidriveSound.stop();const n=this.player.y+200;if(this.cow.x=this.player.x,this.cow.y=Math.min(h-13,n),this.beam.x=this.player.x,this.beam.y=this.player.y+5,this.beam.displayHeight=Math.max(0,this.cow.y+17-this.beam.y),this.beam.setVisible(!0),this.ground.tilePositionX+=m*60*(i/1e3),this.clouds.children.iterate(a=>{if(a.x-=m*60*.2*(i/1e3),a.x<-100){a.x=s+100;const l=Phaser.Math.FloatBetween(.4,1);a.setScale(l),a.y=50+(1-l)*200}return!0}),this.spawnTimer+=i,this.spawnTimer>G*16.6){this.spawnTimer=0;const a=Math.random()>.5?"barn":"silo",l=this.obstacles.create(s+150,h+10,a);l.setOrigin(.5,1),l.setDepth(5),l.body.setAllowGravity(!1),l.body.velocity.x=-m*60,l.passed=!1}this.obstacles.children.iterate(a=>(a&&!a.passed&&a.x<this.cow.x&&(a.passed=!0,this.currentScore++),a&&a.x<-150?a.destroy():a&&(a.body.velocity.x=-m*60),!0)),this.updateHUD()}updateHUD(){this.scoreText.setText(r.SCORE_PREFIX+this.currentScore),this.highScoreText.setText(r.HIGH_SCORE_PREFIX+Math.max(this.highScore,this.currentScore));const t=this.currentFuel/x,i=176;this.fuelBarFill.width=i*t,this.currentFuel<30?(this.fuelBarFill.setFillStyle(10033947),this.fuelWarning.setVisible(!0)):(this.fuelBarFill.setFillStyle(2890769),this.fuelWarning.setVisible(!1))}handleIntro(t,i,e){const s=i*.15,o=e*.25;if(this.introPhase===0){const h=s-this.player.x,n=o-this.player.y;Math.sqrt(h*h+n*n)>5?(this.player.x+=h*.05,this.player.y+=n*.05):(this.player.x=s,this.player.y=o,this.introPhase=1,this.beam.setVisible(!0),this.mooSound.play(),this.cow.play("dangling"))}else if(this.introPhase===1){this.beam.x=this.player.x,this.beam.y=this.player.y+5;const h=this.player.y+200;this.cow.y>h?(this.cow.y-=2.5,this.beam.displayHeight=this.cow.y+17-this.beam.y):(this.cow.y=h,this.introPhase=2)}else this.introPhase===2&&(this.player.body.setAllowGravity(!0),this.player.body.setGravityY(A*1e3),this.isPlaying=!0,this.introPhase=0,this.scheduleRandomMoo())}scheduleRandomMoo(){const t=Phaser.Math.Between(2e4,4e4);this.mooTimer=this.time.delayedCall(t,()=>{this.isPlaying&&!this.isDying&&(this.mooSound.play(),this.scheduleRandomMoo())})}}class B extends Phaser.Scene{constructor(){super("GameOverScene"),this.score=0,this.highScore=0,this.deathReason="ufo"}init(t){this.score=t.score||0,this.highScore=t.highScore||0,this.deathReason=t.deathReason||"ufo"}create(){var u;const{width:t,height:i}=this.scale,e=t/2,s=i/2;this.add.rectangle(e,s,t,i,2890769,.9);const o=Math.min(420,t-40),h=Math.min(320,i-40);this.add.rectangle(e,s,o,h,15984336).setStrokeStyle(4,2890769),this.add.rectangle(e,s,o-16,h-16).setStrokeStyle(1,2890769,.5),this.add.text(e,s-100,r.GAME_OVER_TITLE,{fontFamily:"IM Fell English SC",fontSize:"48px",color:"#2c1c11"}).setOrigin(.5);const n=this.deathReason==="ufo"?r.REASON_UFO:r.REASON_COW;this.add.text(e,s-45,n,{fontFamily:"IM Fell English",fontSize:"22px",color:"#2c1c11",fontStyle:"italic"}).setOrigin(.5),this.add.rectangle(e,s-20,150,1,2890769),this.add.text(e,s+15,r.SCORE_PREFIX+this.score,{fontFamily:"IM Fell English SC",fontSize:"32px",color:"#2c1c11"}).setOrigin(.5),this.score>=this.highScore&&this.score>0&&this.add.text(e,s+55,r.NEW_HIGH_SCORE,{fontFamily:"IM Fell English",fontSize:"18px",color:"#991b1b",fontStyle:"italic"}).setOrigin(.5);const a=s+110,l=this.add.rectangle(e,a,200,50,2890769).setInteractive({useHandCursor:!0});this.add.text(e,a,r.BTN_RETRY,{fontFamily:"IM Fell English",fontSize:"20px",color:"#f3e6d0"}).setOrigin(.5),l.on("pointerover",()=>l.setFillStyle(4864810)),l.on("pointerout",()=>l.setFillStyle(2890769)),l.on("pointerdown",()=>this.restartGame()),(u=this.input.keyboard)==null||u.on("keydown-SPACE",()=>this.restartGame()),this.scale.on("resize",()=>this.scene.restart({score:this.score,highScore:this.highScore,deathReason:this.deathReason}),this)}restartGame(){this.scene.start("GameScene")}}const U={type:Phaser.AUTO,antialias:!0,roundPixels:!0,scale:{mode:Phaser.Scale.RESIZE,parent:"game-container",width:"100%",height:"100%",autoCenter:Phaser.Scale.CENTER_BOTH},backgroundColor:"#f3e6d0",physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},scene:[C,D,L,B]};window.addEventListener("load",()=>{setTimeout(()=>{new Phaser.Game(U)},100)});
